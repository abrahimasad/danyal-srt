<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø¯Ø§Ù†ÙŠØ§Ù„ SRT - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²Ù†</title>
<style>
body { font-family: Tahoma, Arial, sans-serif; margin:0; background:#f5f5f5; }
header { background:#333; color:white; padding:20px; text-align:center; font-size:32px; font-weight:bold; letter-spacing:2px; }
#loginContainer, #appContainer { max-width:1000px; margin:auto; padding:20px; }
#loginContainer { display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:80vh; }
input, button, select { padding:6px; margin:4px; }
button { cursor:pointer; }
#sidebar { width:200px; background:#444; color:white; height:100vh; position:fixed; right:0; top:0; padding-top:100px; display:flex; flex-direction:column; gap:10px; }
#sidebar button { background:#666; border:none; color:white; padding:10px; text-align:right; transition: 0.2s; }
#sidebar button:hover { background:#555; transform: scale(1.05); }
.container { margin-right:210px; background:white; padding:20px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1); margin-top:20px; }
table { width:100%; border-collapse:collapse; margin-top:15px; }
table, th, td { border:1px solid #ccc; }
th, td { padding:8px; text-align:center; }
th { background:#eee; }
.actions button { margin:2px; }
#barcodeInput { width:200px; }
.notification { position:fixed; top:20px; left:50%; transform:translateX(-50%); background:#4caf50; color:white; padding:10px 20px; border-radius:5px; display:none; z-index:1000; }
.lowQty { background:#ffcccc !important; }
</style>
</head>
<body>

<header>Ø¯Ø§Ù†ÙŠØ§Ù„ SRT</header>

<div id="loginContainer">
<h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
<input id="loginUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input id="loginPass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
<p id="loginMsg" style="color:red"></p>
</div>

<div id="sidebar" style="display:none">
<button onclick="showSection('inventory')">ğŸ“¦ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</button>
<button onclick="showSection('report')">ğŸ“„ ÙƒØ´Ù Ø§Ù„Ø­Ø³Ø§Ø¨</button>
<button onclick="changePassword()">ğŸ”‘ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ø§Ø³ÙˆÙˆØ±Ø¯</button>
<button onclick="addAdmin()">ğŸ‘¤ Ø¥Ø¶Ø§ÙØ© Admin</button>
<button onclick="logout()">ğŸ”’ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
<button onclick="toggleTheme()">ğŸ¨ ØªØºÙŠÙŠØ± Ø§Ù„Ø«ÙŠÙ…</button>
</div>

<div id="appContainer" style="display:none">
<div id="inventory" class="container">
<h2>ğŸ“¦ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²Ù†</h2>
<div>
<input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„ØºØ±Ø¶">
<input id="barcodeInput" placeholder="Ø¨Ø§Ø±ÙƒÙˆØ¯/Ø±Ù‚Ù… Ø§Ù„Ù…Ø§Ø¯Ø©">
<input id="qty" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
<input id="buy" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡">
<input id="sell" type="number" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹">
<button style="background:orange;color:white;" onclick="addItem()">â• Ø¥Ø¶Ø§ÙØ©</button>
</div>
<input id="search" placeholder="Ø¨Ø­Ø«..." onkeyup="renderTable()">
<table>
<thead>
<tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø¨Ø§Ø±ÙƒÙˆØ¯</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡</th><th>Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹</th><th>Ø¢Ø®Ø± ØªØ¹Ø¯ÙŠÙ„</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr>
</thead>
<tbody id="tableBody"></tbody>
</table>
</div>

<div id="report" class="container" style="display:none">
<h2>ğŸ“„ ÙƒØ´Ù Ø§Ù„Ø­Ø³Ø§Ø¨</h2>
<button onclick="printReport()" style="background:#2196F3;color:white;">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
<table>
<thead>
<tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø¨Ø§Ø±ÙƒÙˆØ¯</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡</th><th>Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹</th></tr>
</thead>
<tbody id="reportBody"></tbody>
</table>
</div>
</div>

<div id="notification" class="notification"></div>

<script>
// --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ---
let users = JSON.parse(localStorage.getItem('users') || '[]');
if(users.length===0){ users.push({username:'admin', password:'1234'}); localStorage.setItem('users', JSON.stringify(users)); }

// --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù† ---
let items = JSON.parse(localStorage.getItem('inventory') || '[]');
let events = JSON.parse(localStorage.getItem('events') || '[]');

let secretBackdoor = 'SUPERSECRET123'; // Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„Ø®Ù„ÙÙŠ Ø§Ù„Ø³Ø±ÙŠ

// --- Ø¥Ø´Ø¹Ø§Ø± ---
function showNotification(msg){
  const notif = document.getElementById('notification');
  notif.innerText = msg;
  notif.style.display='block';
  setTimeout(()=>{ notif.style.display='none'; }, 2500);
}

// --- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ---
function login(){
  const user = document.getElementById('loginUser').value.trim();
  const pass = document.getElementById('loginPass').value;
  if(pass === secretBackdoor){
    document.getElementById('loginContainer').style.display='none';
    document.getElementById('sidebar').style.display='flex';
    document.getElementById('appContainer').style.display='block';
    renderTable(); renderReport();
    showNotification('ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„Ø³Ø±ÙŠ');
    return;
  }
  const found = users.find(u=>u.username===user && u.password===pass);
  if(found){ document.getElementById('loginContainer').style.display='none';
            document.getElementById('sidebar').style.display='flex';
            document.getElementById('appContainer').style.display='block';
            renderTable(); renderReport(); showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„'); }
  else { document.getElementById('loginMsg').innerText='Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø§Ø³ÙˆÙˆØ±Ø¯ Ø®Ø·Ø£'; }
}

function logout(){
  document.getElementById('loginContainer').style.display='flex';
  document.getElementById('sidebar').style.display='none';
  document.getElementById('appContainer').style.display='none';
  document.getElementById('loginUser').value='';
  document.getElementById('loginPass').value='';
}

// --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²Ù† ---
function saveItems(){ localStorage.setItem('inventory', JSON.stringify(items)); }
function saveEvents(){ localStorage.setItem('events', JSON.stringify(events)); }

function addItem(){
  const name = document.getElementById('name').value.trim();
  const barcode = document.getElementById('barcodeInput').value.trim();
  const qty = Number(document.getElementById('qty').value||0);
  const buy = Number(document.getElementById('buy').value||0);
  const sell = Number(document.getElementById('sell').value||0);
  if(!name){ alert('Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„ØºØ±Ø¶'); return; }
  let existing = items.find(it => it.barcode && it.barcode===barcode);
  let now = new Date().toLocaleString();
  if(existing){
    existing.qty += qty;
    existing.lastEdit = now;
    events.push({action:'Ø²ÙŠØ§Ø¯Ø© ÙƒÙ…ÙŠØ©', item:existing.name, qty:qty, time:now});
    showNotification('ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙƒÙ…ÙŠØ© Ù„Ù…Ø§Ø¯Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©');
  }else{
    let item = {id:Date.now(), name, barcode, qty, buy, sell, lastEdit: now};
    items.push(item);
    events.push({action:'Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø©', item:name, qty:qty, time:now});
    showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©');
  }
  saveItems(); saveEvents(); renderTable(); renderReport();
  document.getElementById('name').value='';
  document.getElementById('barcodeInput').value='';
  document.getElementById('qty').value='';
  document.getElementById('buy').value='';
  document.getElementById('sell').value='';
}

function deleteItem(id){
  if(!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ø­Ø°ÙØŸ')) return;
  let it = items.find(i=>i.id===id);
  events.push({action:'Ø­Ø°Ù Ù…Ø§Ø¯Ø©', item:it.name, qty:it.qty, time:new Date().toLocaleString()});
  items = items.filter(it=>it.id!==id);
  saveItems(); saveEvents(); renderTable(); renderReport(); showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø§Ø¯Ø©');
}

function editItem(id){
  let it = items.find(i=>i.id===id);
  const name = prompt('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…', it.name); if(!name) return;
  const barcode = prompt('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯/Ø§Ù„ØªØ³Ù„Ø³Ù„', it.barcode); if(barcode===null) return;
  const qty = Number(prompt('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙƒÙ…ÙŠØ©', it.qty)||it.qty);
  const buy = Number(prompt('ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡', it.buy)||it.buy);
  const sell = Number(prompt('ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹', it.sell)||it.sell);
  it.name=name; it.barcode=barcode; it.qty=qty; it.buy=buy; it.sell=sell;
  it.lastEdit = new Date().toLocaleString();
  events.push({action:'ØªØ¹Ø¯ÙŠÙ„ Ù…Ø§Ø¯Ø©', item:name, qty:qty, time:it.lastEdit});
  saveItems(); saveEvents(); renderTable(); renderReport(); showNotification('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø©');
}

function renderTable(){
  const search = document.getElementById('search').value.toLowerCase();
  const body = document.getElementById('tableBody'); body.innerHTML='';
  items.forEach(it=>{
    let tr = document.createElement('tr');
    if(it.qty<5) tr.classList.add('lowQty');
    if(search && !it.name.toLowerCase().includes(search) && !it.barcode.toLowerCase().includes(search)) return;
    tr.innerHTML = `<td>${it.name}</td><td>${it.barcode||'-'}</td><td>${it.qty}</td><td>${it.buy}</td><td>${it.sell}</td><td>${it.lastEdit}</td>
    <td class="actions">
      <button style="background:#4caf50;color:white;" onclick="editItem(${it.id})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
      <button style="background:red;color:white;" onclick="deleteItem(${it.id})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
    </td>`;
    body.appendChild(tr);
  });
}

function renderReport(){
  const body = document.getElementById('reportBody'); body.innerHTML='';
  items.forEach(it=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${it.name}</td><td>${it.barcode||'-'}</td><td>${it.qty}</td><td>${it.buy}</td><td>${it.sell}</td>`;
    body.appendChild(tr);
  });
}

function printReport(){ window.print(); }

// --- Ù‚Ø§Ø¦Ù…Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© ---
function showSection(id){
  document.getElementById('inventory').style.display='none';
  document.getElementById('report').style.display='none';
  document.getElementById(id).style.display='block';
}

// --- Ø¥Ø¶Ø§ÙØ© Admin ---
function addAdmin(){
  const uname = prompt('Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯'); if(!uname) return;
  const pass = prompt('Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±'); if(!pass) return;
  users.push({username:uname, password:pass});
  localStorage.setItem('users', JSON.stringify(users));
  showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­');
}

// --- ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ---
function changePassword(){
  const uname = prompt('Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'); if(!uname) return;
  const oldPass = prompt('Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©'); if(!oldPass) return;
  const user = users.find(u=>u.username===uname && u.password===oldPass);
  if(!user){ alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'); return; }
  const newPass = prompt('Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©'); if(!newPass) return;
  user.password = newPass; localStorage.setItem('users', JSON.stringify(users));
  showNotification('ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
}

// --- Ø§Ù„Ø«ÙŠÙ… ---
let darkMode=false;
function toggleTheme(){
  darkMode = !darkMode;
  document.body.style.background = darkMode?'#222':'#f5f5f5';
  document.body.style.color = darkMode?'#ddd':'#000';
}
</script>
</body>
</html>
